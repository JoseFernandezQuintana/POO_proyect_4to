---
title: "Practica 5. Patrones de diseño"
author: "José Fernández Quintana"
format: pdf
---

## Ejemplo: Logger

```{python}
class Logger:
    _instancia = None  # Creamos un atributo de clase donde se guarda la única instancia

    # __new__ controla la creación del objeto antes de __init__
    def __new__(cls, *args, **kwargs):
        # Validar si existe o no la instancia aún
        if cls._instancia is None:
            cls._instancia = super().__new__(cls)
            # Creamos un atributo "archivo" que apunta a un archivo físico
            cls._instancia.archivo = open("app.log", "a")
        return cls._instancia

    def log(self, mensaje):
        self.archivo.write(mensaje + "\n")
        self.archivo.flush()  # Guardar en el disco

logger1 = Logger()
logger2 = Logger()

logger1.log("Inicio de sesión en la aplicación")
logger2.log("El usuario se autenticó correctamente")

print(logger1 is logger2)  # True
```


## Actividad: Presidente

```{python}
class Presidente:
    _instancia = None

    def __new__(cls, nombre):
        if cls._instancia is None:
            cls._instancia = super().__new__(cls)
            cls._instancia.nombre = nombre
            cls._instancia.historial = []
        return cls._instancia

    def accion(self, accion):
        evento = f"{self.nombre} {accion}"
        self.historial.append(evento)
        print(evento)

p1 = Presidente("AMLO")
p2 = Presidente("Peña Nieto")
p3 = Presidente("Fox")

p1.accion("firmó decreto")
p2.accion("visitó España")
p3.accion("aprobó un presupuesto")

print("\n---Historial del Presidente:---")
print(p1.historial)

# Validación de Singleton
print(p1 is p2 is p3)
```

## Preguntas, actividad:
#1. ¿Qué pasaria si eliminamos la verificación if cls._instancia is None en el metodo new?
    # Si quitamos el if, se crearían varias instancias y ya no sería Singleton.

#2. ¿Qué significa el "True" en el p1 is p2 is p3 en el contexto del método sigleton?
    # El True significa que p1, p2 y p3 son el mismo objeto en memoria.

#3. ¿Es buena idea usar Singleton para todo lo que sea global?
    # No, solo conviene usar Singleton en recursos únicos (ej. base de datos, logger), no en todo lo global.

